name: Send Telegram HTML

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths:
      - "*.html"         # k√∂k dizindeki t√ºm html dosyalarƒ±
      - "data/*.html"    # data klas√∂r√ºndeki html dosyalarƒ±

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Send HTML files via Telegram
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          echo "üîç HTML dosyalarƒ± aranƒ±yor..."
          FILES=$(find . -maxdepth 2 -type f -name "*.html")

          if [ -z "$FILES" ]; then
            echo "‚ö†Ô∏è Hi√ß HTML dosyasƒ± bulunamadƒ±!"
            exit 0
          fi

          for FILE in $FILES; do
            echo "üì§ G√∂nderiliyor: $FILE"
            curl -s -X POST "https://api.telegram.org/bot$TELEGRAM_TOKEN/sendDocument" \
              -F chat_id="$TELEGRAM_CHAT_ID" \
              -F document="@$FILE" \
              -F caption="üìä $(basename "$FILE") - $(date +'%d.%m.%Y')"
            echo "‚úÖ G√∂nderildi: $FILE"
          done
